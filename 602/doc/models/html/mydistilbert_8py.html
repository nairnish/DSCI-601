<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DSCI-602: mydistilbert.py File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DSCI-602
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">mydistilbert.py File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespacemydistilbert"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html">mydistilbert</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1a5a63c5fcb2326e09d1b7280a4f1fe0"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a1a5a63c5fcb2326e09d1b7280a4f1fe0">mydistilbert.flat_accuracy</a> (preds, labels)</td></tr>
<tr class="separator:a1a5a63c5fcb2326e09d1b7280a4f1fe0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c26a32d551768d85a93efc682efa316"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a8c26a32d551768d85a93efc682efa316">mydistilbert.format_time</a> (elapsed)</td></tr>
<tr class="separator:a8c26a32d551768d85a93efc682efa316"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ed728d0762aecef03fdbba9366fde1a"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a0ed728d0762aecef03fdbba9366fde1a">mydistilbert.evaluate</a> (y_true, predictions)</td></tr>
<tr class="separator:a0ed728d0762aecef03fdbba9366fde1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:abf2881e5618ba960774677bfc0804b44"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#abf2881e5618ba960774677bfc0804b44">mydistilbert.train_path</a> = 'data/DSL-TRAIN.txt'</td></tr>
<tr class="separator:abf2881e5618ba960774677bfc0804b44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a532d7dc9454c72c270a86296d368144c"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a532d7dc9454c72c270a86296d368144c">mydistilbert.dev_path</a> = 'data/DSL-DEV.txt'</td></tr>
<tr class="separator:a532d7dc9454c72c270a86296d368144c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c2c0e1ff955ee6ebe935fa56676436f"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a8c2c0e1ff955ee6ebe935fa56676436f">mydistilbert.test_path</a> = 'data/DSL-TEST-GOLD.txt'</td></tr>
<tr class="separator:a8c2c0e1ff955ee6ebe935fa56676436f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1c6382aead32e2d4d87f2666881be73"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#ab1c6382aead32e2d4d87f2666881be73">mydistilbert.data</a> = load_data()</td></tr>
<tr class="separator:ab1c6382aead32e2d4d87f2666881be73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c51b3f5b486d454a5d2acd947962c04"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a9c51b3f5b486d454a5d2acd947962c04">mydistilbert.df_train</a> = data.load(train_path)</td></tr>
<tr class="separator:a9c51b3f5b486d454a5d2acd947962c04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7c9c2e062648ecfe31489d74dbc7361"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#ac7c9c2e062648ecfe31489d74dbc7361">mydistilbert.df_test</a> = data.load(test_path)</td></tr>
<tr class="separator:ac7c9c2e062648ecfe31489d74dbc7361"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51ad3bb43e4f0bb0f9bfbcef9303f90d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a51ad3bb43e4f0bb0f9bfbcef9303f90d">mydistilbert.df_val</a> = data.load(dev_path)</td></tr>
<tr class="separator:a51ad3bb43e4f0bb0f9bfbcef9303f90d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6171a25b1f60b7591dedae2688c76095"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a6171a25b1f60b7591dedae2688c76095">mydistilbert.model_checkpoint</a> = &quot;distilbert-base-multilingual-cased&quot;</td></tr>
<tr class="separator:a6171a25b1f60b7591dedae2688c76095"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10ce23a5681e4040aa7f3273793e5722"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a10ce23a5681e4040aa7f3273793e5722">mydistilbert.sentences</a> = df_train[&quot;text&quot;].values</td></tr>
<tr class="separator:a10ce23a5681e4040aa7f3273793e5722"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9540ebf926fb3371518e70388ae05dd6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a9540ebf926fb3371518e70388ae05dd6">mydistilbert.tokenizer</a> = DistilBertTokenizer.from_pretrained(model_checkpoint,use_fast=True)</td></tr>
<tr class="separator:a9540ebf926fb3371518e70388ae05dd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47d43e94d709087903ebb9de74a1869b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a47d43e94d709087903ebb9de74a1869b">mydistilbert.model</a> = DistilBertForSequenceClassification.from_pretrained(model_checkpoint)</td></tr>
<tr class="separator:a47d43e94d709087903ebb9de74a1869b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1efb5f6685341a481e9e22094eaa1bd1"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a1efb5f6685341a481e9e22094eaa1bd1">mydistilbert.input_ids</a> = []</td></tr>
<tr class="separator:a1efb5f6685341a481e9e22094eaa1bd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa88520bec09ccabeb21775c09712b8f7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#aa88520bec09ccabeb21775c09712b8f7">mydistilbert.encoded_sent</a></td></tr>
<tr class="separator:aa88520bec09ccabeb21775c09712b8f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1b52e1a0df7e97f76f7e4c3973dd3a1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#aa1b52e1a0df7e97f76f7e4c3973dd3a1">mydistilbert.MAX_LEN</a> = 64</td></tr>
<tr class="separator:aa1b52e1a0df7e97f76f7e4c3973dd3a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19b2b73d2036757d5d0cdc920ebf5e90"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a19b2b73d2036757d5d0cdc920ebf5e90">mydistilbert.attention_masks</a> = []</td></tr>
<tr class="separator:a19b2b73d2036757d5d0cdc920ebf5e90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a725309e90093227cbc4a54226a58d261"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a725309e90093227cbc4a54226a58d261">mydistilbert.att_mask</a> = [int(token_id &gt; 0) for token_id in sent]</td></tr>
<tr class="separator:a725309e90093227cbc4a54226a58d261"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5b389f95fe2673bf1b5a3c9927c88aa"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#ad5b389f95fe2673bf1b5a3c9927c88aa">mydistilbert.train_masks</a> = attention_masks</td></tr>
<tr class="separator:ad5b389f95fe2673bf1b5a3c9927c88aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae1353224ea002282b997bc112370506"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#aae1353224ea002282b997bc112370506">mydistilbert.sentences1</a> = df_val[&quot;text&quot;].values</td></tr>
<tr class="separator:aae1353224ea002282b997bc112370506"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a664f494a1f28216d64d327f0e27f4ab9"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a664f494a1f28216d64d327f0e27f4ab9">mydistilbert.input_ids1</a> = []</td></tr>
<tr class="separator:a664f494a1f28216d64d327f0e27f4ab9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afaf9554a9cca679bad80db2b25bfef64"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#afaf9554a9cca679bad80db2b25bfef64">mydistilbert.attention_masks2</a> = []</td></tr>
<tr class="separator:afaf9554a9cca679bad80db2b25bfef64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afac971e846322b9f867f537044bdf4fa"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#afac971e846322b9f867f537044bdf4fa">mydistilbert.validation_masks</a> = attention_masks2</td></tr>
<tr class="separator:afac971e846322b9f867f537044bdf4fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae907710ba3debe7bd177d6e06b5dead3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#ae907710ba3debe7bd177d6e06b5dead3">mydistilbert.train_inputs</a> = pd.DataFrame(input_ids)</td></tr>
<tr class="separator:ae907710ba3debe7bd177d6e06b5dead3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b4aa30508fef7eae8d22f9b5cdccc1f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a7b4aa30508fef7eae8d22f9b5cdccc1f">mydistilbert.train_labels</a> = df_train[&quot;language&quot;]</td></tr>
<tr class="separator:a7b4aa30508fef7eae8d22f9b5cdccc1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec33e85448cf1c27609bb7878e18fd59"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#aec33e85448cf1c27609bb7878e18fd59">mydistilbert.validation_inputs</a> = pd.DataFrame(input_ids1)</td></tr>
<tr class="separator:aec33e85448cf1c27609bb7878e18fd59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0105889413e48240b1903f1fc5db501d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a0105889413e48240b1903f1fc5db501d">mydistilbert.validation_labels</a> = df_val[&quot;language&quot;]</td></tr>
<tr class="separator:a0105889413e48240b1903f1fc5db501d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1ab9ef05de66dc8e5b1d9a316e60dbe"><td class="memItemLeft" align="right" valign="top">dictionary&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#ac1ab9ef05de66dc8e5b1d9a316e60dbe">mydistilbert.map1</a> = {'pt-BR':0,'pt-PT':1}</td></tr>
<tr class="separator:ac1ab9ef05de66dc8e5b1d9a316e60dbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addafee56682241cdce25e5cb1f3f6423"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#addafee56682241cdce25e5cb1f3f6423">mydistilbert.batch_size</a> = 32</td></tr>
<tr class="separator:addafee56682241cdce25e5cb1f3f6423"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed2b1a12b2b91854d025d357ff54a5da"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#aed2b1a12b2b91854d025d357ff54a5da">mydistilbert.train_data</a> = TensorDataset(train_inputs, train_masks, train_labels)</td></tr>
<tr class="separator:aed2b1a12b2b91854d025d357ff54a5da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac57c0dc527be52c17cc24fde3273f02b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#ac57c0dc527be52c17cc24fde3273f02b">mydistilbert.train_sampler</a> = RandomSampler(train_data)</td></tr>
<tr class="separator:ac57c0dc527be52c17cc24fde3273f02b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1122536c7f634a4818b3dfe365d68f65"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a1122536c7f634a4818b3dfe365d68f65">mydistilbert.train_dataloader</a> = DataLoader(train_data, sampler=train_sampler, batch_size=batch_size)</td></tr>
<tr class="separator:a1122536c7f634a4818b3dfe365d68f65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67bef29e35945ae38f3583147408b608"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a67bef29e35945ae38f3583147408b608">mydistilbert.validation_data</a> = TensorDataset(validation_inputs, validation_masks, validation_labels)</td></tr>
<tr class="separator:a67bef29e35945ae38f3583147408b608"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addcb5cd1edb91710e45421c4cabc57a3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#addcb5cd1edb91710e45421c4cabc57a3">mydistilbert.validation_sampler</a> = SequentialSampler(validation_data)</td></tr>
<tr class="separator:addcb5cd1edb91710e45421c4cabc57a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a882bd5a2bc232581a6f4c24a8ca9ebb3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a882bd5a2bc232581a6f4c24a8ca9ebb3">mydistilbert.validation_dataloader</a> = DataLoader(validation_data, sampler=validation_sampler, batch_size=batch_size)</td></tr>
<tr class="separator:a882bd5a2bc232581a6f4c24a8ca9ebb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf762652304fc8dee847f839bb80870f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#aaf762652304fc8dee847f839bb80870f">mydistilbert.optimizer</a></td></tr>
<tr class="separator:aaf762652304fc8dee847f839bb80870f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a101a997a7b5f4f96151f136feb74f013"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a101a997a7b5f4f96151f136feb74f013">mydistilbert.epochs</a> = 2</td></tr>
<tr class="separator:a101a997a7b5f4f96151f136feb74f013"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f7285e74a17e66b61bcc2b3369fd98f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a3f7285e74a17e66b61bcc2b3369fd98f">mydistilbert.total_steps</a> = len(train_dataloader) * epochs</td></tr>
<tr class="separator:a3f7285e74a17e66b61bcc2b3369fd98f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafbfd2117f125ab7d6904e379bbeedcb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#aafbfd2117f125ab7d6904e379bbeedcb">mydistilbert.scheduler</a></td></tr>
<tr class="separator:aafbfd2117f125ab7d6904e379bbeedcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac582fa65975057fbc5b4d9f5663fa408"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#ac582fa65975057fbc5b4d9f5663fa408">mydistilbert.device</a> = torch.device('cuda:0')</td></tr>
<tr class="separator:ac582fa65975057fbc5b4d9f5663fa408"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c5652eb9cecd0bf578059c54ce523f4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a1c5652eb9cecd0bf578059c54ce523f4">mydistilbert.device_name</a> = tf.test.gpu_device_name()</td></tr>
<tr class="separator:a1c5652eb9cecd0bf578059c54ce523f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1eabb073fbde646956c1dbb2e3df7d83"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a1eabb073fbde646956c1dbb2e3df7d83">mydistilbert.seed_val</a> = 42</td></tr>
<tr class="separator:a1eabb073fbde646956c1dbb2e3df7d83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4abb8a3af1db7f337e70e9bf2b0f5b6b"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a4abb8a3af1db7f337e70e9bf2b0f5b6b">mydistilbert.loss_values</a> = []</td></tr>
<tr class="separator:a4abb8a3af1db7f337e70e9bf2b0f5b6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add43ab309a850a56296ed51d3fa6eed5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#add43ab309a850a56296ed51d3fa6eed5">mydistilbert.t0</a> = time.time()</td></tr>
<tr class="separator:add43ab309a850a56296ed51d3fa6eed5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5c80297dcb5f598ec179b0252e029c4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#ad5c80297dcb5f598ec179b0252e029c4">mydistilbert.total_loss</a> = 0</td></tr>
<tr class="separator:ad5c80297dcb5f598ec179b0252e029c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5673d13abd16d08807c7fb9875d41636"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a5673d13abd16d08807c7fb9875d41636">mydistilbert.elapsed</a> = format_time(time.time() - t0)</td></tr>
<tr class="separator:a5673d13abd16d08807c7fb9875d41636"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56a9343ccb0f9e43bb19a134769b0851"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a56a9343ccb0f9e43bb19a134769b0851">mydistilbert.b_input_ids</a> = batch[0].to(device)</td></tr>
<tr class="separator:a56a9343ccb0f9e43bb19a134769b0851"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c7542bb2464263f8e13ddcf7ea60fdf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a6c7542bb2464263f8e13ddcf7ea60fdf">mydistilbert.b_input_mask</a> = batch[1].to(device)</td></tr>
<tr class="separator:a6c7542bb2464263f8e13ddcf7ea60fdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72d540c65454e2a53e231f20373b9458"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a72d540c65454e2a53e231f20373b9458">mydistilbert.b_labels</a> = batch[2].to(device)</td></tr>
<tr class="separator:a72d540c65454e2a53e231f20373b9458"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9e94ba7e8804843d2ec24b3158daebb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#ae9e94ba7e8804843d2ec24b3158daebb">mydistilbert.outputs</a></td></tr>
<tr class="separator:ae9e94ba7e8804843d2ec24b3158daebb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4be7196dbe84edf6d0aedff8486eeb75"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a4be7196dbe84edf6d0aedff8486eeb75">mydistilbert.loss</a> = outputs[0]</td></tr>
<tr class="separator:a4be7196dbe84edf6d0aedff8486eeb75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c0a124518414cfc89d6341f8bc26353"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a8c0a124518414cfc89d6341f8bc26353">mydistilbert.avg_train_loss</a> = total_loss / len(train_dataloader)</td></tr>
<tr class="separator:a8c0a124518414cfc89d6341f8bc26353"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40b437ed9a2a74b9e81221df14725835"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a40b437ed9a2a74b9e81221df14725835">mydistilbert.eval_loss</a></td></tr>
<tr class="separator:a40b437ed9a2a74b9e81221df14725835"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a194d55cb7da9336396e17bc8d4007a84"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a194d55cb7da9336396e17bc8d4007a84">mydistilbert.eval_accuracy</a></td></tr>
<tr class="separator:a194d55cb7da9336396e17bc8d4007a84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af45406c6c8a21182659e269cf33a569b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#af45406c6c8a21182659e269cf33a569b">mydistilbert.nb_eval_steps</a></td></tr>
<tr class="separator:af45406c6c8a21182659e269cf33a569b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7bbabd6a781085d4af21e5cd8eab3b1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#ac7bbabd6a781085d4af21e5cd8eab3b1">mydistilbert.nb_eval_examples</a></td></tr>
<tr class="separator:ac7bbabd6a781085d4af21e5cd8eab3b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c062bd1ce1bb854447d866763392ae7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a9c062bd1ce1bb854447d866763392ae7">mydistilbert.batch</a> = tuple(t.to(device) for t in batch)</td></tr>
<tr class="separator:a9c062bd1ce1bb854447d866763392ae7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae70dc1b4080ac0e4ca6557f9c3b423f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#aae70dc1b4080ac0e4ca6557f9c3b423f">mydistilbert.logits</a> = outputs[0]</td></tr>
<tr class="separator:aae70dc1b4080ac0e4ca6557f9c3b423f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22e1ca0dbe8bf8fe37b13140cded3498"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a22e1ca0dbe8bf8fe37b13140cded3498">mydistilbert.label_ids</a> = b_labels.to('cpu').numpy()</td></tr>
<tr class="separator:a22e1ca0dbe8bf8fe37b13140cded3498"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39f56c9321182fe71687983164305210"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a39f56c9321182fe71687983164305210">mydistilbert.tmp_eval_accuracy</a> = flat_accuracy(logits, label_ids)</td></tr>
<tr class="separator:a39f56c9321182fe71687983164305210"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a546b480f8a10c23194cd9a9a042f2ab8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a546b480f8a10c23194cd9a9a042f2ab8">mydistilbert.df</a> = df_test</td></tr>
<tr class="separator:a546b480f8a10c23194cd9a9a042f2ab8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dd121206735f225295009b26880b3bc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a1dd121206735f225295009b26880b3bc">mydistilbert.labels</a> = df[&quot;language&quot;].map(map1)</td></tr>
<tr class="separator:a1dd121206735f225295009b26880b3bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d3662b5c330b5281f969e42646b5069"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a0d3662b5c330b5281f969e42646b5069">mydistilbert.seq_mask</a> = [float(i&gt;0) for i in seq]</td></tr>
<tr class="separator:a0d3662b5c330b5281f969e42646b5069"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dd003e3405358ed15845af2913d1c74"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a1dd003e3405358ed15845af2913d1c74">mydistilbert.prediction_inputs</a> = torch.tensor(input_ids)</td></tr>
<tr class="separator:a1dd003e3405358ed15845af2913d1c74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c2803f279a80243a25824106864ea6b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a3c2803f279a80243a25824106864ea6b">mydistilbert.prediction_masks</a> = torch.tensor(attention_masks)</td></tr>
<tr class="separator:a3c2803f279a80243a25824106864ea6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a389c5a7eefd85e70bf7360e2415e2fc6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a389c5a7eefd85e70bf7360e2415e2fc6">mydistilbert.prediction_labels</a> = torch.tensor(labels)</td></tr>
<tr class="separator:a389c5a7eefd85e70bf7360e2415e2fc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69b75099cd6dc180a2aa5566c01dce73"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a69b75099cd6dc180a2aa5566c01dce73">mydistilbert.prediction_data</a> = TensorDataset(prediction_inputs, prediction_masks, prediction_labels)</td></tr>
<tr class="separator:a69b75099cd6dc180a2aa5566c01dce73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8abed892b1233bb4a53f5bfd2a5fdf01"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a8abed892b1233bb4a53f5bfd2a5fdf01">mydistilbert.prediction_sampler</a> = SequentialSampler(prediction_data)</td></tr>
<tr class="separator:a8abed892b1233bb4a53f5bfd2a5fdf01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af725f818fb0e92e0d95d592baa86b817"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#af725f818fb0e92e0d95d592baa86b817">mydistilbert.prediction_dataloader</a> = DataLoader(prediction_data, sampler=prediction_sampler, batch_size=batch_size)</td></tr>
<tr class="separator:af725f818fb0e92e0d95d592baa86b817"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39aecd99d98c01064f7fd84f40eb141f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#a39aecd99d98c01064f7fd84f40eb141f">mydistilbert.predictions</a></td></tr>
<tr class="separator:a39aecd99d98c01064f7fd84f40eb141f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae34d7c8819587dfc9c327cff84a32bef"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemydistilbert.html#ae34d7c8819587dfc9c327cff84a32bef">mydistilbert.true_labels</a></td></tr>
<tr class="separator:ae34d7c8819587dfc9c327cff84a32bef"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
